# MIDTERM PROJECT TODO - Database Administration

## FOUNDATION - COMPLETE
- [x] Clean codebase structure (consolidated files)
- [x] Database schema with all constraints (db/schema.sql)
- [x] 8 tables with proper relationships
- [x] 25+ indexes for performance
- [x] Demo data loaded (6 users, wallets, loans)
- [x] Backend API with 50+ endpoints
- [x] Frontend pages (login, dashboard, wallet, loans)
- [x] No hardcoded credentials (all use .env)
- [x] Clean README and documentation

## REQUIREMENT 1 - Database Objects Creation - COMPLETE
- [x] Tables with appropriate data types
- [x] Primary keys with AUTO_INCREMENT
- [x] Foreign keys (CASCADE/RESTRICT/SET NULL)
- [x] Indexes on frequently queried columns
- [x] CHECK, UNIQUE, NOT NULL constraints
- [x] DEFAULT values
- [x] Demonstrated in midterm_complete.py

## REQUIREMENT 2 - User Groups and Access Control - COMPLETE
- [x] Create 3 MySQL roles: db_admin, app_user, read_only_analyst
- [x] GRANT privileges differentiated by role:
  - Admin: Full DDL and DML
  - App user: SELECT, INSERT, UPDATE, DELETE on specific tables
  - Read-only: SELECT only
- [x] REVOKE privileges demonstration
- [x] Create test users assigned to roles (admin_user, app_backend, analyst_user)
- [x] Test cases showing successful/denied operations
- [x] Added to db/schema.sql
- [x] Add to midterm_complete.py with logging

## REQUIREMENT 3 - Stored Procedures - NOT STARTED
- [ ] Procedure 1: Loan disbursement (multi-table insert)
  - Create loan record
  - Update wallet balances
  - Create transaction entries
  - Error handling with rollback
- [ ] Procedure 2: Repayment processing
  - Update loan balance
  - Create transaction record
  - Update repayment schedule
  - Calculate remaining balance
- [ ] Procedure 3: Risk assessment calculation
  - Complex business logic
  - Return calculated risk score
  - Input/output parameters
- [ ] Add all to db/schema.sql
- [ ] Add CALL examples to midterm_complete.py

## REQUIREMENT 4 - Views - NOT STARTED
- [ ] Simple view: Active loans (filter by status='ACTIVE')
- [ ] Complex view: Portfolio dashboard
  - Join user, loan, wallet tables
  - Aggregations (total funded, total borrowed)
  - Calculations (ROI, default rate)
- [ ] Security view: User profile without sensitive data
  - Hide password hash
  - Mask KYC data
- [ ] Document use cases for each
- [ ] Add all to db/schema.sql
- [ ] Add to midterm_complete.py

## REQUIREMENT 5 - Query Performance with EXPLAIN - NOT STARTED
- [ ] Query 1: Loan by borrower_id
  - Run EXPLAIN without index
  - Add index on loan.borrower_id
  - Run EXPLAIN with index
  - Compare execution plans
- [ ] Query 2: Payments due by date
  - Run EXPLAIN without index
  - Add index on repayment_schedule.due_date
  - Run EXPLAIN with index
- [ ] Query 3: Transaction history by account_id
  - Run EXPLAIN without index
  - Add index on transaction_ledger.account_id
  - Run EXPLAIN with index
- [ ] Capture output showing sequential vs index scans
- [ ] Document findings in midterm_complete.py

## REQUIREMENT 6 - Data Initialization Strategy - COMPLETE
- [x] Sample data in db/schema.sql
- [x] 6 users with different roles and credit scores
- [x] Wallet accounts for all users
- [x] Loan applications and active loans
- [x] Transaction history
- [x] Foreign key relationships satisfied
- [ ] Document data generation approach in README

## REQUIREMENT 7 - Audit Strategy - PARTIAL
- [x] Audit log table created
- [ ] BEFORE trigger: Validate data before insert/update
  - Example: Ensure loan amount within limits
  - Auto-format data (uppercase status codes)
- [ ] AFTER trigger: Log changes to audit_log
  - Track loan status changes
  - Track wallet balance changes
  - Track user profile updates
- [ ] Audit queries demonstrating:
  - Who modified record X and when?
  - Show all changes in last 7 days
  - Value before/after comparison
- [ ] Add triggers to db/schema.sql
- [ ] Add to midterm_complete.py

## REQUIREMENT 8 - Cascading Deletes - COMPLETE
- [x] CASCADE examples: loan -> repayment_schedule
- [x] RESTRICT examples: user -> loan (prevent delete)
- [ ] Test DELETE operations in midterm_complete.py
- [ ] Show before/after SELECT queries
- [ ] Demonstrate cascading behavior

## REQUIREMENT 9 - Transaction Management and Rollback - PARTIAL
- [x] Demo endpoints show transactions
- [ ] Add to midterm_complete.py:
  - Successful multi-statement transaction
  - Failed transaction with rollback
  - Show database state before/during/after
  - Constraint violation causing rollback
  - Business logic validation failure

## REQUIREMENT 10 - Constraints and Triggers - PARTIAL
- [x] CHECK constraints (credit score 300-850, positive amounts)
- [x] UNIQUE constraints (emails, account numbers)
- [x] NOT NULL on required fields
- [x] DEFAULT values (timestamps, status)
- [ ] Additional BEFORE trigger for validation
- [ ] Additional AFTER trigger for derived data
- [ ] Test cases showing trigger execution
- [ ] Add to midterm_complete.py

## REQUIREMENT 11 - Additional Elements - PARTIAL
- [x] Data types (INT, VARCHAR, DATE, DECIMAL, ENUM-like)
- [x] Normalization (3NF)
- [ ] Backup and recovery strategy:
  - mysqldump command examples
  - Restore procedure documentation
  - Add to README

## IMPLEMENTATION PRIORITY

PHASE 1 - SQL Objects (add to db/schema.sql):
1. Create 3 stored procedures
2. Create 3 views
3. Create 2 triggers (BEFORE and AFTER)
4. Test all objects execute successfully

PHASE 2 - Access Control (separate or in midterm_complete.py):
1. Create MySQL roles
2. Create test users
3. GRANT/REVOKE demonstrations
4. Test access restrictions

PHASE 3 - Complete midterm_complete.py:
1. Add methods for requirements 2-11
2. Each requirement logs to MIDTERM_SUBMISSION.log
3. Include EXPLAIN output
4. Include before/after states
5. Test full execution

PHASE 4 - Documentation:
1. Run midterm_complete.py to generate log
2. Create PDF with screenshots and explanations
3. Record 10-15 minute video walkthrough
4. Update README with backup strategy

## DELIVERABLES CHECKLIST
- [ ] db/schema.sql - Complete with procedures, views, triggers
- [ ] midterm_complete.py - All 11 requirements demonstrated
- [ ] MIDTERM_SUBMISSION.log - Complete output log
- [ ] PDF document with screenshots and explanations
- [ ] Video demonstration (10-15 minutes)
- [ ] README updated with all documentation
- [ ] All tests passing
- [ ] No hardcoded credentials

## NOTES
- Foundation is solid and ready for implementation
- Schema is production-ready with proper constraints
- Backend/frontend working and tested
- Need to focus on SQL objects and midterm_complete.py
